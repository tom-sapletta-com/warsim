<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symulator Obronny Polski 2025 - Analiza Strategiczna v2.0</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(20, 20, 35, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            text-align: center;
            color: #ff4444;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .disclaimer {
            background: rgba(255, 68, 68, 0.2);
            border: 2px solid #ff4444;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background: rgba(40, 40, 60, 0.8);
            border-radius: 15px;
            padding: 20px;
            height: 400px;
            position: relative;
        }
        
        .chart-title {
            color: #4fc3f7;
            margin-bottom: 15px;
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(70, 70, 100, 0.8), rgba(50, 50, 80, 0.8));
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .stat-card h3 {
            color: #4fc3f7;
            margin-bottom: 10px;
            font-size: 0.9em;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-change {
            font-size: 0.8em;
            color: #ff9800;
        }
        
        .critical-stat {
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.3), rgba(183, 28, 28, 0.3));
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .scenario-section {
            background: rgba(40, 40, 60, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .scenario-section h2 {
            color: #ffa726;
            margin-bottom: 20px;
            font-size: 1.6em;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 8px;
            transition: background 0.3s;
            font-size: 0.9em;
        }
        
        .checkbox-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 10px;
            cursor: pointer;
        }
        
        .checkbox-item label {
            cursor: pointer;
            flex: 1;
        }
        
        .checkbox-item .impact {
            color: #ff9800;
            font-size: 0.8em;
            margin-left: 5px;
        }
        
        .simulation-controls {
            display: flex;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4caf50, #45a049);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
        }
        
        .btn-info {
            background: linear-gradient(135deg, #03a9f4, #0288d1);
            color: white;
        }
        
        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .timeline {
            background: rgba(30, 30, 50, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            height: 500px;
            overflow-y: auto;
        }
        
        .timeline h2 {
            color: #4fc3f7;
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            background: rgba(30, 30, 50, 0.95);
            padding: 10px 0;
        }
        
        .day-log {
            background: rgba(255, 255, 255, 0.02);
            border-left: 3px solid #4fc3f7;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .day-marker {
            font-weight: bold;
            color: #ffa726;
            font-size: 1.2em;
        }
        
        .day-status {
            display: flex;
            gap: 10px;
            font-size: 0.9em;
        }
        
        .timeline-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            margin: 8px 0;
            border-radius: 6px;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .timeline-item.critical {
            background: rgba(244, 67, 54, 0.2);
            border-left: 3px solid #f44336;
        }
        
        .timeline-item.warning {
            background: rgba(255, 152, 0, 0.2);
            border-left: 3px solid #ff9800;
        }
        
        .timeline-item.success {
            background: rgba(76, 175, 80, 0.2);
            border-left: 3px solid #4caf50;
        }
        
        .timeline-item.info {
            background: rgba(3, 169, 244, 0.2);
            border-left: 3px solid #03a9f4;
        }
        
        .event-time {
            color: #888;
            font-size: 0.8em;
            min-width: 50px;
        }
        
        .casualties-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
            padding: 10px;
            background: rgba(255, 0, 0, 0.1);
            border-radius: 8px;
        }
        
        .casualty-item {
            text-align: center;
        }
        
        .casualty-number {
            font-size: 1.2em;
            font-weight: bold;
            color: #ff5252;
        }
        
        .casualty-label {
            font-size: 0.8em;
            color: #aaa;
        }
        
        .infrastructure-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .infra-item {
            background: rgba(255, 152, 0, 0.1);
            padding: 8px;
            border-radius: 6px;
            text-align: center;
            font-size: 0.85em;
        }
        
        .infra-damage {
            color: #ff9800;
            font-weight: bold;
        }
        
        .nato-response-panel {
            background: rgba(3, 169, 244, 0.1);
            border: 1px solid #03a9f4;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .nato-response-panel h3 {
            color: #03a9f4;
            margin-bottom: 10px;
        }
        
        .nato-country {
            display: inline-block;
            margin: 5px;
            padding: 5px 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            font-size: 0.9em;
        }
        
        .nato-country.ready {
            background: rgba(76, 175, 80, 0.3);
            border: 1px solid #4caf50;
        }
        
        .nato-country.preparing {
            background: rgba(255, 152, 0, 0.3);
            border: 1px solid #ff9800;
        }
        
        .nato-country.delayed {
            background: rgba(244, 67, 54, 0.3);
            border: 1px solid #f44336;
        }
        
        .analysis-panel {
            background: linear-gradient(135deg, rgba(70, 70, 90, 0.8), rgba(50, 50, 70, 0.8));
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        
        .metric-display {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px;
            border-radius: 8px;
        }
        
        .metric-label {
            color: #4fc3f7;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .metric-value {
            font-size: 1.3em;
            font-weight: bold;
        }
        
        .threat-assessment {
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid #ff4444;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .threat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .threat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
        }
        
        .threat-level-bar {
            width: 100px;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .threat-level-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ff6666);
            transition: width 0.5s ease;
        }
        
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(79, 195, 247, 0.5);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(79, 195, 247, 0.7);
        }
        
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🛡️ SYMULATOR OBRONNY POLSKI 2025 v2.0 🛡️</h1>
        
        <div class="disclaimer">
            ⚠️ UWAGA: Symulacja edukacyjna oparta na danych publicznych. Zawiera realistyczne szacunki strat. Nie reprezentuje rzeczywistych planów obronnych.
        </div>
        
        <!-- Główne statystyki -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>🪖 Siły Zbrojne RP</h3>
                <div class="stat-value" id="plForces">210,300</div>
                <div class="stat-change" id="plForcesChange">Pełna gotowość</div>
            </div>
            
            <div class="stat-card">
                <h3>👥 Ludność Cywilna</h3>
                <div class="stat-value" id="civilians">38.0 mln</div>
                <div class="stat-change" id="civiliansStatus">Bez strat</div>
            </div>
            
            <div class="stat-card">
                <h3>🏭 Infrastruktura</h3>
                <div class="stat-value" id="infrastructure">100%</div>
                <div class="stat-change" id="infraStatus">Sprawna</div>
            </div>
            
            <div class="stat-card">
                <h3>🤝 Wsparcie NATO</h3>
                <div class="stat-value" id="natoSupport">Oczekujące</div>
                <div class="stat-change" id="natoETA">Art. 5 nieaktywny</div>
            </div>
            
            <div class="stat-card">
                <h3>⏱️ Dzień Wojny</h3>
                <div class="stat-value" id="currentDay">0</div>
                <div class="stat-change" id="dayStatus">Pokój</div>
            </div>
            
            <div class="stat-card critical-stat">
                <h3>💀 Łączne Straty</h3>
                <div class="stat-value" id="totalCasualties">0</div>
                <div class="stat-change" id="casualtyRate">0/dzień</div>
            </div>
        </div>
        
        <!-- Wykresy analityczne -->
        <div class="dashboard-grid">
            <div class="chart-container">
                <div class="chart-title">📊 Diagram Radarowy - Potencjał Obronny</div>
                <canvas id="radarChart"></canvas>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">📈 Dynamika Konfliktu - Trendy Czasowe</div>
                <canvas id="histogramChart"></canvas>
            </div>
        </div>
        
        <!-- Panel konfiguracji -->
        <div class="scenario-section">
            <h2>⚔️ Scenariusz Ataku - Wektory Zagrożenia</h2>
            
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="kaliningrad" checked>
                    <label for="kaliningrad">🚀 Królewiec: Iskander-M, S-400 <span class="impact">(+40% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="belarus" checked>
                    <label for="belarus">🪖 Białoruś: 60k wojsk + Wagner <span class="impact">(+35% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="drones">
                    <label for="drones">🛸 Roje dronów: Shahed-136, Lancet <span class="impact">(+25% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="cyber">
                    <label for="cyber">💻 Cyberwojna: infrastruktura krytyczna <span class="impact">(+20% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="baltic">
                    <label for="baltic">⚓ Flota Bałtycka: blokada morska <span class="impact">(+25% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="missiles">
                    <label for="missiles">🎯 Pociski manewrujące: Kalibr, Kh-101 <span class="impact">(+30% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="airborne">
                    <label for="airborne">🪂 Desant VDV: 10k elitarnych <span class="impact">(+20% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="hybrid">
                    <label for="hybrid">🕵️ Wojna hybrydowa: sabotaż <span class="impact">(+15% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="nuclear">
                    <label for="nuclear">☢️ Groźba nuklearna (taktyczna) <span class="impact">(+50% zagrożenia)</span></label>
                </div>
            </div>
            
            <h2 style="margin-top: 30px;">🛡️ Zdolności Obronne</h2>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="nato" checked>
                    <label for="nato">🤝 Art. 5 NATO (opóźnienie 48-72h) <span class="impact">(-60% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="patriot" checked>
                    <label for="patriot">🛡️ 2x Patriot PAC-3 <span class="impact">(-25% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="f35">
                    <label for="f35">✈️ F-35 operacyjne (3 szt.) <span class="impact">(-20% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="himars" checked>
                    <label for="himars">🎯 20x HIMARS z ATACMS <span class="impact">(-30% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="mobilization">
                    <label for="mobilization">📢 Pełna mobilizacja (300k rezerw) <span class="impact">(-35% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="tarczaWschod">
                    <label for="tarczaWschod">🏰 Tarcza Wschód (fortyfikacje) <span class="impact">(-40% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="k2tanks" checked>
                    <label for="k2tanks">🚜 180 K2 + 116 Abrams <span class="impact">(-25% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="allies">
                    <label for="allies">🌍 Wsparcie UE (ograniczone) <span class="impact">(-30% zagrożenia)</span></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="ukraineSupport">
                    <label for="ukraineSupport">🇺🇦 Drugi front ukraiński <span class="impact">(-20% zagrożenia)</span></label>
                </div>
            </div>
        </div>
        
        <!-- Kontrolki symulacji -->
        <div class="simulation-controls">
            <button class="btn btn-primary" onclick="startSimulation()" id="startBtn">▶️ ROZPOCZNIJ SYMULACJĘ</button>
            <button class="btn btn-warning" onclick="pauseSimulation()" id="pauseBtn" disabled>⏸️ PAUZA</button>
            <button class="btn btn-danger" onclick="resetSimulation()">🔄 RESET</button>
            <button class="btn btn-info" onclick="exportData()">📊 EKSPORT DANYCH</button>
            <select id="simSpeed" class="btn" style="background: #673ab7;">
                <option value="1000">Prędkość: Normalna (1 dzień/s)</option>
                <option value="500">Prędkość: Szybka (2 dni/s)</option>
                <option value="2000">Prędkość: Wolna (0.5 dnia/s)</option>
                <option value="100">Prędkość: Bardzo szybka</option>
            </select>
        </div>
        
        <!-- Panel analizy zagrożeń -->
        <div class="threat-assessment">
            <h3>⚠️ Ocena Zagrożenia</h3>
            <div class="threat-grid">
                <div class="threat-item">
                    <span>Przewaga powietrzna</span>
                    <div class="threat-level-bar">
                        <div class="threat-level-fill" id="airThreat" style="width: 70%"></div>
                    </div>
                </div>
                <div class="threat-item">
                    <span>Przewaga lądowa</span>
                    <div class="threat-level-bar">
                        <div class="threat-level-fill" id="landThreat" style="width: 85%"></div>
                    </div>
                </div>
                <div class="threat-item">
                    <span>Zagrożenie rakietowe</span>
                    <div class="threat-level-bar">
                        <div class="threat-level-fill" id="missileThreat" style="width: 90%"></div>
                    </div>
                </div>
                <div class="threat-item">
                    <span>Cyberzagrożenie</span>
                    <div class="threat-level-bar">
                        <div class="threat-level-fill" id="cyberThreatBar" style="width: 60%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Mapa taktyczna -->
        <div class="map-container" style="background: rgba(30, 30, 50, 0.95);">
            <h2 style="color: #4fc3f7; margin-bottom: 15px;">🗺️ Mapa Taktyczna - Sytuacja Operacyjna</h2>
            <div style="position: relative; width: 100%; height: 500px;">
                <svg id="tacticalMap" viewBox="0 0 800 600" style="width: 100%; height: 100%;">
                    <!-- Tło mapy -->
                    <rect width="800" height="600" fill="#1a1a2e"/>
                    
                    <!-- Siatka współrzędnych -->
                    <g id="grid" stroke="rgba(255,255,255,0.05)" stroke-width="0.5">
                        <line x1="0" y1="150" x2="800" y2="150"/>
                        <line x1="0" y1="300" x2="800" y2="300"/>
                        <line x1="0" y1="450" x2="800" y2="450"/>
                        <line x1="200" y1="0" x2="200" y2="600"/>
                        <line x1="400" y1="0" x2="400" y2="600"/>
                        <line x1="600" y1="0" x2="600" y2="600"/>
                    </g>
                    
                    <!-- Kraje sąsiednie -->
                    <g id="neighbors">
                        <!-- Niemcy -->
                        <rect x="0" y="200" width="100" height="200" fill="rgba(100,100,120,0.3)" stroke="rgba(255,255,255,0.3)"/>
                        <text x="50" y="300" fill="#888" text-anchor="middle" font-size="14">NIEMCY</text>
                        
                        <!-- Czechy -->
                        <rect x="100" y="400" width="150" height="100" fill="rgba(100,100,120,0.3)" stroke="rgba(255,255,255,0.3)"/>
                        <text x="175" y="450" fill="#888" text-anchor="middle" font-size="14">CZECHY</text>
                        
                        <!-- Słowacja -->
                        <rect x="250" y="450" width="200" height="100" fill="rgba(100,100,120,0.3)" stroke="rgba(255,255,255,0.3)"/>
                        <text x="350" y="500" fill="#888" text-anchor="middle" font-size="14">SŁOWACJA</text>
                        
                        <!-- Ukraina -->
                        <rect x="450" y="400" width="250" height="200" fill="rgba(80,100,80,0.3)" stroke="rgba(255,255,255,0.3)"/>
                        <text x="575" y="500" fill="#888" text-anchor="middle" font-size="14">UKRAINA</text>
                        
                        <!-- Białoruś -->
                        <rect x="500" y="100" width="200" height="250" fill="rgba(150,50,50,0.3)" stroke="rgba(255,0,0,0.5)"/>
                        <text x="600" y="225" fill="#f88" text-anchor="middle" font-size="14">BIAŁORUŚ</text>
                        
                        <!-- Litwa -->
                        <rect x="450" y="0" width="150" height="100" fill="rgba(100,100,120,0.3)" stroke="rgba(255,255,255,0.3)"/>
                        <text x="525" y="50" fill="#888" text-anchor="middle" font-size="14">LITWA</text>
                        
                        <!-- Królewiec (Rosja) -->
                        <rect x="300" y="0" width="150" height="100" fill="rgba(200,50,50,0.3)" stroke="rgba(255,0,0,0.5)"/>
                        <text x="375" y="50" fill="#f88" text-anchor="middle" font-size="14">KRÓLEWIEC</text>
                        <text x="375" y="70" fill="#f66" text-anchor="middle" font-size="10">(ROSJA)</text>
                        
                        <!-- Morze Bałtyckie -->
                        <rect x="0" y="0" width="300" height="150" fill="rgba(50,100,150,0.2)" stroke="rgba(100,150,200,0.3)"/>
                        <text x="150" y="75" fill="#6af" text-anchor="middle" font-size="14">MORZE BAŁTYCKIE</text>
                    </g>
                    
                    <!-- Polska -->
                    <g id="poland">
                        <path d="M 100 150 L 600 100 L 700 350 L 450 450 L 250 400 L 100 350 Z" 
                              fill="rgba(50,100,200,0.2)" 
                              stroke="rgba(100,150,255,0.8)" 
                              stroke-width="2"/>
                        <text x="350" y="275" fill="#4fc3f7" text-anchor="middle" font-size="20" font-weight="bold">POLSKA</text>
                    </g>
                    
                    <!-- Miasta główne -->
                    <g id="cities">
                        <!-- Warszawa -->
                        <circle cx="420" cy="280" r="8" fill="#4fc3f7" stroke="white" stroke-width="2"/>
                        <text x="420" y="305" fill="white" text-anchor="middle" font-size="12">Warszawa</text>
                        
                        <!-- Kraków -->
                        <circle cx="380" cy="380" r="6" fill="#4fc3f7" stroke="white" stroke-width="1"/>
                        <text x="380" y="400" fill="white" text-anchor="middle" font-size="11">Kraków</text>
                        
                        <!-- Gdańsk -->
                        <circle cx="350" cy="150" r="6" fill="#4fc3f7" stroke="white" stroke-width="1"/>
                        <text x="350" y="140" fill="white" text-anchor="middle" font-size="11">Gdańsk</text>
                        
                        <!-- Poznań -->
                        <circle cx="250" cy="250" r="6" fill="#4fc3f7" stroke="white" stroke-width="1"/>
                        <text x="250" y="270" fill="white" text-anchor="middle" font-size="11">Poznań</text>
                        
                        <!-- Wrocław -->
                        <circle cx="250" cy="340" r="6" fill="#4fc3f7" stroke="white" stroke-width="1"/>
                        <text x="250" y="360" fill="white" text-anchor="middle" font-size="11">Wrocław</text>
                        
                        <!-- Białystok -->
                        <circle cx="520" cy="230" r="6" fill="#4fc3f7" stroke="white" stroke-width="1"/>
                        <text x="520" y="220" fill="white" text-anchor="middle" font-size="11">Białystok</text>
                        
                        <!-- Lublin -->
                        <circle cx="480" cy="340" r="6" fill="#4fc3f7" stroke="white" stroke-width="1"/>
                        <text x="480" y="360" fill="white" text-anchor="middle" font-size="11">Lublin</text>
                    </g>
                    
                    <!-- Bazy wojskowe -->
                    <g id="militaryBases">
                        <!-- Łask (F-16) -->
                        <rect x="315" y="295" width="30" height="20" fill="rgba(0,100,255,0.5)" stroke="#0066ff"/>
                        <text x="330" y="308" fill="white" text-anchor="middle" font-size="9">✈ Łask</text>
                        
                        <!-- Malbork (22 BLT) -->
                        <rect x="360" y="180" width="30" height="20" fill="rgba(0,100,255,0.5)" stroke="#0066ff"/>
                        <text x="375" y="193" fill="white" text-anchor="middle" font-size="9">✈ Malbork</text>
                        
                        <!-- Żagań (11 LDKPanc) -->
                        <rect x="200" y="280" width="30" height="20" fill="rgba(0,100,255,0.5)" stroke="#0066ff"/>
                        <text x="215" y="293" fill="white" text-anchor="middle" font-size="9">🚜 Żagań</text>
                        
                        <!-- Orzysz (15 BZ) -->
                        <rect x="470" y="170" width="30" height="20" fill="rgba(0,100,255,0.5)" stroke="#0066ff"/>
                        <text x="485" y="183" fill="white" text-anchor="middle" font-size="9">🚜 Orzysz</text>
                    </g>
                    
                    <!-- Warstwa dla jednostek (dynamiczna) -->
                    <g id="unitLayer"></g>
                    
                    <!-- Warstwa dla starć (dynamiczna) -->
                    <g id="battleLayer"></g>
                    
                    <!-- Warstwa dla strzałek ruchu (dynamiczna) -->
                    <g id="movementLayer"></g>
                    
                    <!-- Legenda -->
                    <g id="legend" transform="translate(650, 450)">
                        <rect x="0" y="0" width="140" height="140" fill="rgba(0,0,0,0.7)" stroke="rgba(255,255,255,0.3)"/>
                        <text x="70" y="15" fill="white" text-anchor="middle" font-size="11" font-weight="bold">LEGENDA</text>
                        
                        <circle cx="15" cy="35" r="5" fill="#4caf50"/>
                        <text x="25" y="40" fill="white" font-size="10">Wygrana potyczka</text>
                        
                        <circle cx="15" cy="55" r="5" fill="#f44336"/>
                        <text x="25" y="60" fill="white" font-size="10">Przegrana</text>
                        
                        <circle cx="15" cy="75" r="5" fill="#ff9800"/>
                        <text x="25" y="80" fill="white" font-size="10">Walka trwa</text>
                        
                        <rect x="10" y="90" width="10" height="10" fill="rgba(0,100,255,0.5)"/>
                        <text x="25" y="100" fill="white" font-size="10">Siły polskie</text>
                        
                        <rect x="10" y="110" width="10" height="10" fill="rgba(255,0,0,0.5)"/>
                        <text x="25" y="120" fill="white" font-size="10">Siły wroga</text>
                    </g>
                    
                    <!-- Wskaźniki kierunków ataku -->
                    <defs>
                        <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#f44336"/>
                        </marker>
                        <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#2196f3"/>
                        </marker>
                    </defs>
                </svg>
                
                <!-- Panel informacji o mapie -->
                <div style="position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.8); padding: 10px; border-radius: 8px; max-width: 200px;">
                    <div style="color: #4fc3f7; font-weight: bold; margin-bottom: 5px;">Status Operacyjny</div>
                    <div id="mapStatus" style="font-size: 12px; color: #ccc;">
                        <div>Fronty aktywne: <span id="activeFronts">0</span></div>
                        <div>Potyczki w toku: <span id="ongoingBattles">0</span></div>
                        <div>Miasta zagrożone: <span id="threatenedCities">0</span></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Panel wsparcia NATO -->
            <h3>🤝 Status Wsparcia NATO</h3>
            <div id="natoCountries">
                <span class="nato-country delayed">🇺🇸 USA (72h)</span>
                <span class="nato-country preparing">🇬🇧 UK (48h)</span>
                <span class="nato-country preparing">🇩🇪 Niemcy (48h)</span>
                <span class="nato-country delayed">🇫🇷 Francja (60h)</span>
                <span class="nato-country ready">🇱🇹 Litwa (6h)</span>
                <span class="nato-country ready">🇪🇪 Estonia (12h)</span>
                <span class="nato-country preparing">🇳🇴 Norwegia (36h)</span>
                <span class="nato-country delayed">🇹🇷 Turcja (96h)</span>
                <span class="nato-country preparing">🇨🇿 Czechy (24h)</span>
                <span class="nato-country ready">🇸🇰 Słowacja (12h)</span>
            </div>
        </div>
        
        <!-- Panel analizy -->
        <div class="analysis-panel">
            <h3>📊 Analiza Bieżąca</h3>
            <div class="analysis-grid">
                <div class="metric-display">
                    <div class="metric-label">Bilans Sił</div>
                    <div class="metric-value" id="forceBalance">1:7.1</div>
                </div>
                <div class="metric-display">
                    <div class="metric-label">Tempo Strat</div>
                    <div class="metric-value" id="lossRate">0/h</div>
                </div>
                <div class="metric-display">
                    <div class="metric-label">Amunicja</div>
                    <div class="metric-value" id="ammoStatus">100%</div>
                </div>
                <div class="metric-display">
                    <div class="metric-label">Morale</div>
                    <div class="metric-value" id="morale">100%</div>
                </div>
                <div class="metric-display">
                    <div class="metric-label">Koszt Wojny</div>
                    <div class="metric-value" id="warCost">0 mld PLN</div>
                </div>
                <div class="metric-display">
                    <div class="metric-label">Prognoza</div>
                    <div class="metric-value" id="forecast">Nieznana</div>
                </div>
            </div>
        </div>
        
        <!-- Szczegółowa oś czasu -->
        <div class="timeline">
            <h2>📅 Dziennik Wydarzeń</h2>
            <div id="timelineEvents"></div>
        </div>
    </div>
    
    <script>
        // Zmienne globalne
        let simulationRunning = false;
        let simulationPaused = false;
        let currentDay = 0;
        let currentHour = 0;
        let simulationInterval;
        let radarChart, histogramChart;
        let dailyLogs = [];
        let battles = [];
        let units = [];
        
        // Pozycje strategiczne na mapie
        const strategicPoints = {
            cities: {
                'Warszawa': { x: 420, y: 280, value: 10 },
                'Kraków': { x: 380, y: 380, value: 7 },
                'Gdańsk': { x: 350, y: 150, value: 8 },
                'Poznań': { x: 250, y: 250, value: 6 },
                'Wrocław': { x: 250, y: 340, value: 6 },
                'Białystok': { x: 520, y: 230, value: 5 },
                'Lublin': { x: 480, y: 340, value: 5 },
                'Szczecin': { x: 150, y: 180, value: 4 },
                'Rzeszów': { x: 450, y: 400, value: 4 }
            },
            borders: {
                'Terespol': { x: 580, y: 280, side: 'belarus' },
                'Kuźnica': { x: 540, y: 200, side: 'belarus' },
                'Bobrowniki': { x: 560, y: 180, side: 'belarus' },
                'Medyka': { x: 530, y: 420, side: 'ukraine' },
                'Gołdap': { x: 500, y: 120, side: 'kaliningrad' },
                'Gronowo': { x: 450, y: 100, side: 'kaliningrad' },
                'Słubice': { x: 100, y: 250, side: 'germany' },
                'Cieszyn': { x: 350, y: 450, side: 'czech' }
            }
        };
        
        
        // Bardziej realistyczne dane bazowee(
                    cityData.x + (Math.random() - 0.5) * 40,
                    cityData.y + (Math.random() - 0.5) * 40,
                    `Walka o ${randomCity}`,
                    'ongoing'
                );
            }
            
            // Aktualizacja statystyk mapy
            updateMapStatus();
        }
        
        function updateMapStatus() {
            const activeFronts = document.getElementById('activeFronts');
            const ongoingBattles = document.getElementById('ongoingBattles');
            const threatenedCities = document.getElementById('threatenedCities');
            
            let fronts = new Set();
            battles.forEach(battle => {
                if (battle.status === 'ongoing') {
                    // Określ front na podstawie lokalizacji
                    if (battle.x > 500) fronts.add('wschodni');
                    if (battle.x < 200) fronts.add('zachodni');
                    if (battle.y < 200) fronts.add('północny');
                    if (battle.y > 400) fronts.add('południowy');
                }
            });
            
            activeFronts.textContent = fronts.size;
            ongoingBattles.textContent = battles.filter(b => b.status === 'ongoing').length;
            
            // Miasta zagrożone
            let threatened = 0;
            Object.entries(strategicPoints.cities).forEach(([name, city]) => {
                const nearbyBattle = battles.find(b => 
                    b.status === 'ongoing' &&
                    Math.sqrt(Math.pow(b.x - city.x, 2) + Math.pow(b.y - city.y, 2)) < 50
                );
                if (nearbyBattle) threatened++;
            });
            threatenedCities.textContent = threatened;
        }
        const warData = {
            poland: {
                military: {
                    personnel: 210300,
                    reserves: 300000,
                    tanks: 430,
                    ifv: 800,  // BWP + Rosomak
                    artillery: 140,
                    aircraft: 80,
                    helicopters: 100,
                    airDefense: 25,
                    himars: 20
                },
                civilian: {
                    population: 38000000,
                    majorCities: ['Warszawa', 'Kraków', 'Łódź', 'Wrocław', 'Poznań', 'Gdańsk'],
                    criticalInfra: {
                        powerPlants: 100,
                        waterSupply: 100,
                        hospitals: 100,
                        communications: 100,
                        transport: 100,
                        fuel: 100
                    }
                },
                economy: {
                    dailyGDP: 7.2, // mld PLN
                    defenseSpending: 0.51, // mld PLN dziennie
                    emergencyReserves: 50 // mld PLN
                }
            },
            enemy: {
                russia: {
                    totalForces: 1500000,
                    availableForPoland: 300000, // realistyczna liczba
                    tanks: 2000,
                    ifv: 3500,
                    artillery: 1500,
                    aircraft: 400,
                    missiles: {
                        iskander: 50,
                        kalibr: 100,
                        kh101: 80,
                        shahed: 500
                    }
                },
                belarus: {
                    forces: 60000,
                    tanks: 500,
                    wagner: 10000
                }
            },
            nato: {
                rapidResponse: 40000,
                article5Forces: 500000,
                countriesResponse: {
                    'USA': { forces: 100000, responseTime: 72, equipment: 'high' },
                    'UK': { forces: 30000, responseTime: 48, equipment: 'high' },
                    'Germany': { forces: 50000, responseTime: 48, equipment: 'medium' },
                    'France': { forces: 40000, responseTime: 60, equipment: 'high' },
                    'Lithuania': { forces: 15000, responseTime: 6, equipment: 'low' },
                    'Estonia': { forces: 10000, responseTime: 12, equipment: 'low' },
                    'Czech': { forces: 25000, responseTime: 24, equipment: 'medium' },
                    'Slovakia': { forces: 15000, responseTime: 12, equipment: 'low' },
                    'Romania': { forces: 30000, responseTime: 36, equipment: 'medium' },
                    'Norway': { forces: 20000, responseTime: 36, equipment: 'high' }
                }
            },
            casualties: {
                military: { poland: 0, enemy: 0, nato: 0 },
                civilian: 0,
                infrastructure: {},
                equipment: {
                    poland: { tanks: 0, aircraft: 0, artillery: 0 },
                    enemy: { tanks: 0, aircraft: 0, artillery: 0 }
                }
            }
        };
        
        // Kopia do resetowania
        const initialWarData = JSON.parse(JSON.stringify(warData));
        
        // Inicjalizacja wykresów
        function initializeCharts() {
            // Diagram radarowy
            const radarCtx = document.getElementById('radarChart').getContext('2d');
            radarChart = new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: ['Siły Lądowe', 'Lotnictwo', 'Obrona Powietrzna', 'Wsparcie NATO', 'Logistyka', 'Cyberoborna', 'Morale', 'Rezerwy'],
                    datasets: [{
                        label: 'Polska + NATO',
                        data: [50, 40, 60, 0, 70, 50, 100, 80],
                        borderColor: 'rgba(79, 195, 247, 1)',
                        backgroundColor: 'rgba(79, 195, 247, 0.2)',
                        pointBackgroundColor: 'rgba(79, 195, 247, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff'
                    }, {
                        label: 'Siły Przeciwnika',
                        data: [85, 80, 70, 0, 60, 70, 80, 90],
                        borderColor: 'rgba(244, 67, 54, 1)',
                        backgroundColor: 'rgba(244, 67, 54, 0.2)',
                        pointBackgroundColor: 'rgba(244, 67, 54, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
                            pointLabels: { color: '#ccc', font: { size: 10 } },
                            ticks: { color: '#999', backdropColor: 'transparent' }
                        }
                    },
                    plugins: {
                        legend: { 
                            labels: { color: '#ccc', font: { size: 11 } }
                        }
                    }
                }
            });
            
            // Wykres liniowy
            const histCtx = document.getElementById('histogramChart').getContext('2d');
            histogramChart = new Chart(histCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Straty Wojskowe PL',
                        data: [],
                        borderColor: 'rgba(79, 195, 247, 1)',
                        backgroundColor: 'rgba(79, 195, 247, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        pointRadius: 4,
                        pointBackgroundColor: 'rgba(79, 195, 247, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 1,
                        pointHoverRadius: 6
                    }, {
                        label: 'Straty Cywilne',
                        data: [],
                        borderColor: 'rgba(255, 152, 0, 1)',
                        backgroundColor: 'rgba(255, 152, 0, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        pointRadius: 4,
                        pointBackgroundColor: 'rgba(255, 152, 0, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 1,
                        pointHoverRadius: 6
                    }, {
                        label: 'Zniszczenia Infrastruktury (%)',
                        data: [],
                        borderColor: 'rgba(244, 67, 54, 1)',
                        backgroundColor: 'rgba(244, 67, 54, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        pointRadius: 4,
                        pointBackgroundColor: 'rgba(244, 67, 54, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 1,
                        pointHoverRadius: 6,
                        yAxisID: 'y1'
                    }, {
                        label: 'Straty Sprzętu',
                        data: [],
                        borderColor: 'rgba(156, 39, 176, 1)',
                        backgroundColor: 'rgba(156, 39, 176, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        pointRadius: 4,
                        pointBackgroundColor: 'rgba(156, 39, 176, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 1,
                        pointHoverRadius: 6,
                        borderDash: [5, 5]
                    }, {
                        label: 'Morale (%)',
                        data: [],
                        borderColor: 'rgba(76, 175, 80, 1)',
                        backgroundColor: 'rgba(76, 175, 80, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        pointRadius: 4,
                        pointBackgroundColor: 'rgba(76, 175, 80, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 1,
                        pointHoverRadius: 6,
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            position: 'left',
                            title: { display: true, text: 'Straty (osoby/sprzęt)', color: '#ccc' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#999' }
                        },
                        y1: {
                            beginAtZero: true,
                            position: 'right',
                            max: 100,
                            title: { display: true, text: 'Procent (%)', color: '#ccc' },
                            grid: { drawOnChartArea: false },
                            ticks: { color: '#999' }
                        },
                        x: {
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#999' }
                        }
                    },
                    plugins: {
                        legend: { 
                            labels: { color: '#ccc', font: { size: 11 } },
                            position: 'top'
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: 'rgba(255, 255, 255, 0.2)',
                            borderWidth: 1,
                            displayColors: true,
                            mode: 'index',
                            intersect: false
                        }
                    }
                }
            });
        }
        
        // Obliczanie balansu sił
        function calculateForceBalance() {
            let polandStrength = 1.0;
            let enemyStrength = 1.0;
            
            // Modyfikatory ataku
            if (document.getElementById('kaliningrad').checked) enemyStrength *= 1.4;
            if (document.getElementById('belarus').checked) enemyStrength *= 1.35;
            if (document.getElementById('drones').checked) enemyStrength *= 1.25;
            if (document.getElementById('cyber').checked) enemyStrength *= 1.2;
            if (document.getElementById('baltic').checked) enemyStrength *= 1.25;
            if (document.getElementById('missiles').checked) enemyStrength *= 1.3;
            if (document.getElementById('airborne').checked) enemyStrength *= 1.2;
            if (document.getElementById('hybrid').checked) enemyStrength *= 1.15;
            if (document.getElementById('nuclear').checked) enemyStrength *= 1.5;
            
            // Modyfikatory obrony
            if (document.getElementById('nato').checked) polandStrength *= 2.5;
            if (document.getElementById('patriot').checked) polandStrength *= 1.25;
            if (document.getElementById('f35').checked) polandStrength *= 1.2;
            if (document.getElementById('himars').checked) polandStrength *= 1.3;
            if (document.getElementById('mobilization').checked) polandStrength *= 1.35;
            if (document.getElementById('tarczaWschod').checked) polandStrength *= 1.4;
            if (document.getElementById('k2tanks').checked) polandStrength *= 1.25;
            if (document.getElementById('allies').checked) polandStrength *= 1.3;
            if (document.getElementById('ukraineSupport').checked) polandStrength *= 1.2;
            
            return {
                ratio: polandStrength / enemyStrength,
                polandStrength,
                enemyStrength
            };
        }
        
        // Symulacja dnia wojny
        function simulateDay(day) {
            const balance = calculateForceBalance();
            const dayLog = {
                day: day,
                hour: 0,
                events: [],
                casualties: { military: 0, civilian: 0 },
                infrastructure: 0
            };
            
            // Intensywność walk zależy od balansu sił
            const intensity = Math.max(0.1, Math.min(1, 2 - balance.ratio));
            
            // Straty wojskowe - bardziej realistyczne
            const baseMilitaryLosses = Math.floor(300 + Math.random() * 700);
            dayLog.casualties.military = Math.floor(baseMilitaryLosses * intensity);
            warData.casualties.military.poland += dayLog.casualties.military;
            
            // Straty cywilne - zależne od scenariusza
            if (document.getElementById('missiles').checked || document.getElementById('drones').checked) {
                dayLog.casualties.civilian = Math.floor((50 + Math.random() * 200) * intensity);
                warData.casualties.civilian += dayLog.casualties.civilian;
            }
            
            // Zniszczenia infrastruktury
            if (day === 1) {
                // Pierwszy dzień - masowe uderzenia
                if (document.getElementById('missiles').checked) {
                    warData.poland.civilian.criticalInfra.powerPlants -= 20;
                    warData.poland.civilian.criticalInfra.communications -= 15;
                    dayLog.infrastructure = 35;
                    dayLog.events.push({
                        time: '00:30',
                        type: 'critical',
                        message: '🚀 Salwa 50+ pocisków Kalibr/Iskander na infrastrukturę'
                    });
                }
                if (document.getElementById('cyber').checked) {
                    warData.poland.civilian.criticalInfra.communications -= 25;
                    dayLog.events.push({
                        time: '00:00',
                        type: 'warning',
                        message: '💻 Masowy cyberatak na sieci energetyczne i bankowe'
                    });
                }
            }
            
            // Wydarzenia specyficzne dla dnia
            generateDayEvents(day, dayLog, balance);
            
            // NATO response
            handleNATOResponse(day, dayLog);
            
            // Aktualizacja mapy taktycznej
            simulateMapEvents(day, balance);
            
            // Aktualizacja UI
            updateDayLog(dayLog);
            updateStatistics(day);
            updateCharts(day, dayLog);
            
            dailyLogs.push(dayLog);
            
            // Sprawdzenie warunków zakończenia
            if (warData.casualties.military.poland > warData.poland.military.personnel * 0.5) {
                endSimulation('defeat');
            } else if (day > 30 && balance.ratio > 1.5) {
                endSimulation('victory');
            }
        }
        
        // Generowanie wydarzeń dnia
        function generateDayEvents(day, dayLog, balance) {
            // Dzień 1 - Pierwsze uderzenia
            if (day === 1) {
                dayLog.events.push({
                    time: '03:00',
                    type: 'critical',
                    message: '⚡ Początek operacji "Burza" - masowe uderzenia'
                });
                
                if (document.getElementById('kaliningrad').checked) {
                    dayLog.events.push({
                        time: '03:15',
                        type: 'critical',
                        message: '🚀 Iskander z Królewca - cele: Gdańsk, Olsztyn'
                    });
                }
                
                if (document.getElementById('airborne').checked) {
                    dayLog.events.push({
                        time: '04:00',
                        type: 'warning',
                        message: '🪂 Desant VDV pod Warszawą - próba zajęcia lotniska'
                    });
                }
            }
            
            // Dzień 2 - NATO reaguje
            if (day === 2) {
                if (document.getElementById('nato').checked) {
                    dayLog.events.push({
                        time: '12:00',
                        type: 'success',
                        message: '🤝 Rada NATO - jednogłośna aktywacja Art. 5'
                    });
                }
            }
            
            // Dzień 3 - Pierwsze wsparcie
            if (day === 3) {
                if (document.getElementById('nato').checked) {
                    dayLog.events.push({
                        time: '06:00',
                        type: 'success',
                        message: '✈️ Pierwsze F-35 USA lądują w Łasku'
                    });
                }
                
                if (document.getElementById('belarus').checked) {
                    dayLog.events.push({
                        time: '09:00',
                        type: 'critical',
                        message: '🪖 Białoruś przekracza granicę w 3 punktach'
                    });
                }
            }
            
            // Późniejsze dni - eskalacja lub stabilizacja
            if (day > 7) {
                if (balance.ratio < 0.8) {
                    dayLog.events.push({
                        time: '12:00',
                        type: 'critical',
                        message: '⚠️ Sytuacja krytyczna - linie obrony pod presją'
                    });
                } else if (balance.ratio > 1.2) {
                    dayLog.events.push({
                        time: '15:00',
                        type: 'success',
                        message: '✅ Kontrofensywa - odbijamy utracone tereny'
                    });
                }
            }
            
            // Wydarzenia losowe
            if (Math.random() > 0.7) {
                const randomEvents = [
                    { type: 'info', message: '🚁 Śmigłowce ewakuacyjne transportują rannych' },
                    { type: 'warning', message: '⚡ Przerwy w dostawach prądu w regionie' },
                    { type: 'info', message: '🚚 Konwój humanitarny dotarł do strefy walk' },
                    { type: 'success', message: '🎯 HIMARS zniszczył składy amunicji przeciwnika' },
                    { type: 'critical', message: '💥 Ostrzał artyleryjski przedmieść miasta' }
                ];
                const event = randomEvents[Math.floor(Math.random() * randomEvents.length)];
                event.time = `${Math.floor(Math.random() * 24).toString().padStart(2, '0')}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}`;
                dayLog.events.push(event);
            }
        }
        
        // Obsługa odpowiedzi NATO
        function handleNATOResponse(day, dayLog) {
            const natoCountries = document.getElementById('natoCountries');
            
            Object.entries(warData.nato.countriesResponse).forEach(([country, data]) => {
                const responseDay = Math.ceil(data.responseTime / 24);
                if (day === responseDay) {
                    dayLog.events.push({
                        time: '12:00',
                        type: 'success',
                        message: `🤝 ${country} - ${data.forces.toLocaleString()} żołnierzy przybywa`
                    });
                    
                    // Aktualizacja siły obronnej
                    warData.poland.military.personnel += data.forces;
                    
                    // Aktualizacja UI
                    const countryElements = natoCountries.getElementsByClassName('nato-country');
                    for (let elem of countryElements) {
                        if (elem.textContent.includes(country)) {
                            elem.classList.remove('delayed', 'preparing');
                            elem.classList.add('ready');
                        }
                    }
                }
            });
        }
        
        // Aktualizacja dziennika
        function updateDayLog(dayLog) {
            const timeline = document.getElementById('timelineEvents');
            
            const dayDiv = document.createElement('div');
            dayDiv.className = 'day-log';
            
            // Nagłówek dnia
            const header = document.createElement('div');
            header.className = 'day-header';
            header.innerHTML = `
                <span class="day-marker">Dzień ${dayLog.day}</span>
                <span class="day-status">
                    <span>⚔️ ${dayLog.casualties.military}</span>
                    <span>👥 ${dayLog.casualties.civilian}</span>
                    <span>🏭 -${dayLog.infrastructure}%</span>
                </span>
            `;
            dayDiv.appendChild(header);
            
            // Wydarzenia dnia
            dayLog.events.forEach(event => {
                const eventDiv = document.createElement('div');
                eventDiv.className = `timeline-item ${event.type}`;
                eventDiv.innerHTML = `
                    <span class="event-time">${event.time}</span>
                    <span>${event.message}</span>
                `;
                dayDiv.appendChild(eventDiv);
            });
            
            // Podsumowanie strat
            if (dayLog.casualties.military > 0 || dayLog.casualties.civilian > 0) {
                const casualties = document.createElement('div');
                casualties.className = 'casualties-summary';
                casualties.innerHTML = `
                    <div class="casualty-item">
                        <div class="casualty-number">${dayLog.casualties.military}</div>
                        <div class="casualty-label">Straty wojskowe</div>
                    </div>
                    <div class="casualty-item">
                        <div class="casualty-number">${dayLog.casualties.civilian}</div>
                        <div class="casualty-label">Straty cywilne</div>
                    </div>
                    <div class="casualty-item">
                        <div class="casualty-number">${Math.floor(dayLog.casualties.military * 2.5)}</div>
                        <div class="casualty-label">Ranni</div>
                    </div>
                `;
                dayDiv.appendChild(casualties);
            }
            
            // Zniszczenia infrastruktury
            if (dayLog.infrastructure > 0) {
                const infra = document.createElement('div');
                infra.className = 'infrastructure-grid';
                Object.entries(warData.poland.civilian.criticalInfra).forEach(([key, value]) => {
                    if (value < 100) {
                        infra.innerHTML += `
                            <div class="infra-item">
                                <div>${key.replace(/([A-Z])/g, ' $1').trim()}</div>
                                <div class="infra-damage">${value}%</div>
                            </div>
                        `;
                    }
                });
                if (infra.innerHTML) dayDiv.appendChild(infra);
            }
            
            timeline.insertBefore(dayDiv, timeline.firstChild);
        }
        
        // Aktualizacja statystyk
        function updateStatistics(day) {
            // Siły zbrojne
            const remainingForces = warData.poland.military.personnel - warData.casualties.military.poland;
            document.getElementById('plForces').textContent = remainingForces.toLocaleString();
            document.getElementById('plForcesChange').textContent = 
                `Straty: ${warData.casualties.military.poland.toLocaleString()}`;
            
            // Ludność cywilna
            const remainingCivilians = warData.poland.civilian.population - warData.casualties.civilian;
            document.getElementById('civilians').textContent = 
                (remainingCivilians / 1000000).toFixed(1) + ' mln';
            document.getElementById('civiliansStatus').textContent = 
                `Straty: ${warData.casualties.civilian.toLocaleString()}`;
            
            // Infrastruktura
            const avgInfra = Object.values(warData.poland.civilian.criticalInfra)
                .reduce((a, b) => a + b, 0) / 6;
            document.getElementById('infrastructure').textContent = 
                Math.floor(avgInfra) + '%';
            document.getElementById('infraStatus').textContent = 
                avgInfra < 50 ? 'Krytyczna' : avgInfra < 75 ? 'Uszkodzona' : 'Częściowo sprawna';
            
            // Dzień wojny
            document.getElementById('currentDay').textContent = day;
            document.getElementById('dayStatus').textContent = 'Wojna totalna';
            
            // Straty łączne
            const totalCasualties = warData.casualties.military.poland + warData.casualties.civilian;
            document.getElementById('totalCasualties').textContent = totalCasualties.toLocaleString();
            document.getElementById('casualtyRate').textContent = 
                `${Math.floor(totalCasualties / day)}/dzień`;
            
            // Panel analizy
            const balance = calculateForceBalance();
            document.getElementById('forceBalance').textContent = 
                `1:${(1/balance.ratio).toFixed(1)}`;
            document.getElementById('lossRate').textContent = 
                `${Math.floor(warData.casualties.military.poland / day / 24)}/h`;
            document.getElementById('ammoStatus').textContent = 
                Math.max(0, 100 - day * 3) + '%';
            document.getElementById('morale').textContent = 
                Math.max(30, 100 - totalCasualties / 1000) + '%';
            document.getElementById('warCost').textContent = 
                (day * 5.5).toFixed(1) + ' mld PLN';
            
            const forecast = balance.ratio > 1.2 ? 'Korzystna' : 
                           balance.ratio > 0.8 ? 'Niepewna' : 'Krytyczna';
            document.getElementById('forecast').textContent = forecast;
            
            // NATO status
            if (day >= 2 && document.getElementById('nato').checked) {
                document.getElementById('natoSupport').textContent = 'Aktywne';
                document.getElementById('natoETA').textContent = 'Art. 5 aktywny';
            }
        }
        
        // Aktualizacja wykresów
        function updateCharts(day, dayLog) {
            // Aktualizacja diagramu radarowego
            const balance = calculateForceBalance();
            const natoActive = day >= 2 && document.getElementById('nato').checked;
            
            radarChart.data.datasets[0].data = [
                Math.max(20, 50 - (warData.casualties.military.poland / 1000)),
                Math.max(10, 40 - day * 2),
                document.getElementById('patriot').checked ? 60 : 30,
                natoActive ? 80 : 0,
                Math.max(30, 70 - day * 2),
                document.getElementById('cyber').checked ? 30 : 50,
                Math.max(30, 100 - (warData.casualties.civilian / 100)),
                document.getElementById('mobilization').checked ? 80 : 40
            ];
            
            radarChart.data.datasets[1].data = [
                85 - (warData.casualties.military.enemy / 1000),
                80 - day,
                70,
                0,
                60 - day,
                document.getElementById('cyber').checked ? 70 : 40,
                80,
                90
            ];
            radarChart.update();
            
            // Aktualizacja wykresu liniowego
            if (histogramChart.data.labels.length > 15) {
                histogramChart.data.labels.shift();
                histogramChart.data.datasets.forEach(dataset => dataset.data.shift());
            }
            
            histogramChart.data.labels.push(`Dzień ${day}`);
            
            // Straty wojskowe
            histogramChart.data.datasets[0].data.push(dayLog.casualties.military);
            
            // Straty cywilne
            histogramChart.data.datasets[1].data.push(dayLog.casualties.civilian);
            
            // Zniszczenia infrastruktury
            const infraDamage = 100 - Object.values(warData.poland.civilian.criticalInfra)
                .reduce((a, b) => a + b, 0) / 6;
            histogramChart.data.datasets[2].data.push(infraDamage);
            
            // Straty sprzętu (symulowane)
            const equipmentLosses = Math.floor(day * 5 + Math.random() * 10);
            histogramChart.data.datasets[3].data.push(equipmentLosses);
            
            // Morale
            const morale = Math.max(30, 100 - (warData.casualties.military.poland + warData.casualties.civilian) / 500);
            histogramChart.data.datasets[4].data.push(morale);
            
            histogramChart.update();
        }
        
        // Rozpoczęcie symulacji
        function startSimulation() {
            if (simulationRunning) return;
            
            simulationRunning = true;
            simulationPaused = false;
            currentDay = 0;
            dailyLogs = [];
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = false;
            
            // Reset danych
            Object.assign(warData, JSON.parse(JSON.stringify(initialWarData)));
            
            // Czyszczenie timeline
            document.getElementById('timelineEvents').innerHTML = '';
            
            // Inicjalizacja mapy
            initializeMap();
            
            // Rozpoczęcie symulacji
            const speed = parseInt(document.getElementById('simSpeed').value);
            
            simulationInterval = setInterval(() => {
                if (!simulationPaused) {
                    currentDay++;
                    simulateDay(currentDay);
                    
                    if (currentDay >= 60) {
                        endSimulation('timeout');
                    }
                }
            }, speed);
        }
        
        // Pauza symulacji
        function pauseSimulation() {
            if (!simulationRunning) return;
            
            simulationPaused = !simulationPaused;
            document.getElementById('pauseBtn').textContent = 
                simulationPaused ? '▶️ WZNÓW' : '⏸️ PAUZA';
        }
        
        // Reset symulacji
        function resetSimulation() {
            clearInterval(simulationInterval);
            simulationRunning = false;
            simulationPaused = false;
            currentDay = 0;
            
            // Reset UI
            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('pauseBtn').textContent = '⏸️ PAUZA';
            document.getElementById('timelineEvents').innerHTML = '';
            
            // Reset danych
            Object.assign(warData, JSON.parse(JSON.stringify(initialWarData)));
            
            // Reset mapy
            initializeMap();
            
            // Reset statystyk
            document.getElementById('plForces').textContent = '210,300';
            document.getElementById('plForcesChange').textContent = 'Pełna gotowość';
            document.getElementById('civilians').textContent = '38.0 mln';
            document.getElementById('civiliansStatus').textContent = 'Bez strat';
            document.getElementById('infrastructure').textContent = '100%';
            document.getElementById('infraStatus').textContent = 'Sprawna';
            document.getElementById('natoSupport').textContent = 'Oczekujące';
            document.getElementById('natoETA').textContent = 'Art. 5 nieaktywny';
            document.getElementById('currentDay').textContent = '0';
            document.getElementById('dayStatus').textContent = 'Pokój';
            document.getElementById('totalCasualties').textContent = '0';
            document.getElementById('casualtyRate').textContent = '0/dzień';
            
            // Reset statystyk mapy
            document.getElementById('activeFronts').textContent = '0';
            document.getElementById('ongoingBattles').textContent = '0';
            document.getElementById('threatenedCities').textContent = '0';
            
            // Reset wykresów
            if (histogramChart) {
                histogramChart.data.labels = [];
                histogramChart.data.datasets.forEach(dataset => dataset.data = []);
                histogramChart.update();
            }
            if (radarChart) {
                radarChart.data.datasets[0].data = [50, 40, 60, 0, 70, 50, 100, 80];
                radarChart.data.datasets[1].data = [85, 80, 70, 0, 60, 70, 80, 90];
                radarChart.update();
            }
            
            // Reset NATO status
            const natoCountries = document.getElementById('natoCountries').getElementsByClassName('nato-country');
            for (let elem of natoCountries) {
                elem.classList.remove('ready');
                elem.classList.add(elem.textContent.includes('72h') || elem.textContent.includes('96h') ? 'delayed' : 'preparing');
            }
        }
        
        // Zakończenie symulacji
        function endSimulation(reason) {
            clearInterval(simulationInterval);
            simulationRunning = false;
            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            
            let message = '';
            let type = 'info';
            
            switch(reason) {
                case 'victory':
                    message = '✅ ZWYCIĘSTWO - Agresja odparta, terytorium obronione';
                    type = 'success';
                    break;
                case 'defeat':
                    message = '❌ KLĘSKA - Siły obronne wyczerpane';
                    type = 'critical';
                    break;
                case 'timeout':
                    message = '⏱️ KONIEC SYMULACJI - 60 dni wojny';
                    type = 'warning';
                    break;
            }
            
            // Dodaj podsumowanie
            const timeline = document.getElementById('timelineEvents');
            const summary = document.createElement('div');
            summary.className = 'day-log';
            summary.innerHTML = `
                <div class="day-header">
                    <span class="day-marker">PODSUMOWANIE</span>
                </div>
                <div class="timeline-item ${type}">
                    <span>${message}</span>
                </div>
                <div class="casualties-summary">
                    <div class="casualty-item">
                        <div class="casualty-number">${warData.casualties.military.poland.toLocaleString()}</div>
                        <div class="casualty-label">Straty wojskowe PL</div>
                    </div>
                    <div class="casualty-item">
                        <div class="casualty-number">${warData.casualties.civilian.toLocaleString()}</div>
                        <div class="casualty-label">Straty cywilne</div>
                    </div>
                    <div class="casualty-item">
                        <div class="casualty-number">${(currentDay * 5.5).toFixed(1)} mld PLN</div>
                        <div class="casualty-label">Koszt wojny</div>
                    </div>
                </div>
            `;
            timeline.insertBefore(summary, timeline.firstChild);
        }
        
        // Eksport danych
        function exportData() {
            const data = {
                simulationDate: new Date().toISOString(),
                parameters: {
                    attackVectors: [],
                    defenseFactors: []
                },
                results: {
                    daysSimulated: currentDay,
                    casualties: warData.casualties,
                    infrastructure: warData.poland.civilian.criticalInfra,
                    cost: currentDay * 5.5 + ' mld PLN'
                },
                dailyLogs: dailyLogs
            };
            
            // Zbierz parametry
            document.querySelectorAll('.checkbox-item input').forEach(input => {
                if (input.checked) {
                    const category = input.closest('.checkbox-group').previousElementSibling.textContent.includes('Atak') ? 
                        'attackVectors' : 'defenseFactors';
                    data.parameters[category].push(input.nextElementSibling.textContent);
                }
            });
            
            // Pobierz jako JSON
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `symulacja_obronna_polska_2025_dzien${currentDay}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Inicjalizacja po załadowaniu
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            
            // Listener dla checkboxów
            document.querySelectorAll('.checkbox-item input').forEach(input => {
                input.addEventListener('change', function() {
                    if (!simulationRunning) {
                        const balance = calculateForceBalance();
                        document.getElementById('forceBalance').textContent = 
                            `1:${(1/balance.ratio).toFixed(1)}`;
                        
                        // Aktualizacja zagrożeń
                        document.getElementById('airThreat').style.width = 
                            (document.getElementById('drones').checked ? 90 : 70) + '%';
                        document.getElementById('landThreat').style.width = 
                            (document.getElementById('belarus').checked ? 95 : 85) + '%';
                        document.getElementById('missileThreat').style.width = 
                            (document.getElementById('missiles').checked ? 100 : 90) + '%';
                        document.getElementById('cyberThreatBar').style.width = 
                            (document.getElementById('cyber').checked ? 80 : 60) + '%';
                    }
                });
            });
        });
    </script>
</body>
</html>
